<form [formGroup]="transactionForm" (submit)="handleFormSubmit()">
  <h1 class="expense-form__header">Create Transaction</h1>
  <mat-form-field appearance="outline">
    <mat-label>Amount</mat-label>
    <input matInput formControlName="amount" type="number" />
    <mat-icon class="expense-form__icon" matSuffix>euro</mat-icon>
    <mat-error *ngIf="amount?.hasError('required')"
      >Please add transaction amount</mat-error
    >
  </mat-form-field>
  <mat-form-field appearance="outline">
    <mat-label>Wallet</mat-label>
    <mat-select formControlName="walletId" disableOptionCentering>
      <mat-option *ngFor="let wallet of wallets" [value]="wallet.id">
        {{
          wallet.name + ' (' + (wallet.currentBalance | priceTransform) + ')'
        }}
      </mat-option>
    </mat-select>
    <mat-error *ngIf="walletId?.hasError('required')"
      >Please select wallet</mat-error
    >
  </mat-form-field>
  <mat-form-field appearance="outline">
    <mat-label>Category</mat-label>
    <mat-select disableOptionCentering formControlName="subcategory">
      <mat-select-trigger>
        {{ category?.value + ' - ' + (subcategory?.value | titlecase) }}
      </mat-select-trigger>
      <mat-optgroup
        *ngFor="let category of categories"
        [label]="category.category"
      >
        <mat-option
          *ngFor="let subcategory of category.subcategories"
          [value]="subcategory"
          (onSelectionChange)="onCategorySelection($event, category.category)"
        >
          {{ subcategory | titlecase }}
        </mat-option>
      </mat-optgroup>
    </mat-select>
    <mat-error *ngIf="category?.hasError('required')"
      >Please select category</mat-error
    >
  </mat-form-field>
  <mat-form-field appearance="outline">
    <mat-label>Choose a date</mat-label>
    <input
      class="input_date"
      matInput
      type="datetime-local"
      formControlName="date"
    />
    <mat-error *ngIf="date?.hasError('required')">Please select date</mat-error>
    <mat-error
      *ngIf="!date?.hasError('required') && date?.hasError('dateFormat')"
      >Please enter a valid date format</mat-error
    >
  </mat-form-field>
  <mat-form-field appearance="outline">
    <mat-label
      >Recipient<span class="expense-form__optional-field">
        (optional)</span
      ></mat-label
    >
    <input matInput formControlName="transactionTo" />
  </mat-form-field>
  <mat-form-field appearance="outline">
    <mat-label
      >Location<span class="expense-form__optional-field">
        (optional)</span
      ></mat-label
    >
    <input matInput formControlName="location" />
  </mat-form-field>
  <mat-form-field appearance="outline">
    <mat-label
      >Description<span class="expense-form__optional-field">
        (optional)</span
      ></mat-label
    >
    <textarea
      #message
      maxlength="150"
      matInput
      formControlName="description"
    ></textarea>
    <mat-hint align="end">{{ message.value.length }} / 150</mat-hint>
  </mat-form-field>
  <p>
    <mat-checkbox formControlName="isRecurringTransaction"
      >Make this recurring transaction</mat-checkbox
    >
  </p>
  <button
    class="expense-form__button"
    mat-raised-button
    type="submit"
    color="primary"
    [disabled]="!transactionForm.valid"
  >
    Save Transaction
  </button>
</form>
